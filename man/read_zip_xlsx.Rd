% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wgi.R
\name{read_zip_xlsx}
\alias{read_zip_xlsx}
\title{Download, unzip, and read Excel workbook(s) from a ZIP URL}
\usage{
read_zip_xlsx(
  url,
  file_pattern = "\\\\.xlsx$",
  sheet = NULL,
  read_all = FALSE,
  verbose = TRUE,
  keep_dir = FALSE
)
}
\arguments{
\item{url}{Character. Direct link to the ZIP file.}

\item{file_pattern}{Regex to select files inside the ZIP (default: \code{"\\\\.xlsx$"}).}

\item{sheet}{Sheet to read when \code{read_all = FALSE}. Can be \code{NULL} (first sheet),
a sheet name, or an index. Ignored when \code{read_all = TRUE}.}

\item{read_all}{Logical. If \code{TRUE}, read \strong{all} sheets from \strong{all} .xlsx files
and return a nested named list. If \code{FALSE} (default), read a single sheet.}

\item{verbose}{Logical. Print progress messages (default \code{TRUE}).}

\item{keep_dir}{Logical. If \code{TRUE}, keep the extracted directory and return
its path (as an attribute). Otherwise itâ€™s created in tempdir (default \code{FALSE}).}
}
\value{
If \code{read_all = FALSE}: a data.frame/tibble of the requested sheet.
If \code{read_all = TRUE}: a nested named list \verb{list(<file> = list(<sheet> = tibble, ...), ...)}.
In both cases, the return value has attributes \code{zip_path}, \code{unzip_dir}, and \code{files}.
}
\description{
\strong{Edict:} Fetch a ZIP from the web, extract \emph{.xlsx} files, and read either
the first sheet of the first workbook (default) or all sheets from all workbooks.
}
\examples{
\dontrun{
url <- "https://www.worldbank.org/content/dam/sites/govindicators/doc/wgidataset_excel.zip"
# Read the first sheet of the first workbook
df <- read_zip_xlsx(url)

# Read a specific sheet by name
df2 <- read_zip_xlsx(url, sheet = "Data")

# Read all sheets from all workbooks
all_tbls <- read_zip_xlsx(url, read_all = TRUE)
names(all_tbls)                # files
names(all_tbls[[1]])           # sheets in first file
}
}
